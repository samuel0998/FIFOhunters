<!DOCTYPE html>
<html>
<head>
    <title>FIFO Hunters</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
<div class="top">
    <h1>FIFO HUNTERS</h1>
    <a href="{{ url_for('upload_page') }}" class="btn-upload">
        Atualizar Planilha
    </a>
</div>


<div class="scan-box">
    <input id="scanInput" placeholder="EAN / ASIN / ISD" autofocus>
    <button onclick="scanFIFO()">Scan</button>
</div>

<div id="results"></div>

<script>
async function scanFIFO() {
    const code = document.getElementById("scanInput").value.trim();
    const container = document.getElementById("results");

    container.innerHTML = "<p>Buscando...</p>";

    if (!code) {
        container.innerHTML = "<p>Informe um c√≥digo</p>";
        return;
    }

    const res = await fetch(`/api/scan?code=${code}`);
    const data = await res.json();

    if (!data.length) {
        container.innerHTML = "<p>Nenhum dado encontrado</p>";
        return;
    }

    container.innerHTML = "";

    data.forEach(item => {
    const card = document.createElement("div");
    card.className = `card ${item.status.toLowerCase()}`;

    card.innerHTML = `
        <div class="cone ${item.cone_cor}"></div>

        <h3>${item.produto}</h3>

        <p><b>ISA:</b> ${item.isa}</p>
        <p><b>ISD:</b> ${item.isd}</p>
        <p><b>Data abertura:</b> ${item.data_abertura || "-"}</p>

        <div class="highlight">
            <div>
                <span>FALTA</span>
                <strong>${item.falta_receber}</strong>
            </div>
            <div>
                <span>FIFO DAYS</span>
                <strong>${item.fifo_days}</strong>
            </div>
            <div>
                <span>STATUS</span>
                <strong>${item.status}</strong>
            </div>
        </div>
    `;

    container.appendChild(card);
});

}
</script>

</body>
</html>
